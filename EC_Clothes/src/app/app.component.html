<!-- <div class="whole" *ngIf = "loggedIn">
  <div class = "aside">
    <h1><a href="">Clothes EC</a></h1>
    <a href="category"><i class="fas fa-list" style="font-size:15px;"></i>  Categories</a>
    <a href="product"><i class="fas fa-box" style="font-size:15px;"></i>  Products</a>
    <a href="transaction"><i class="fas fa-money-bill" style="font-size:15px;"></i>  Transactions</a>
    <a href="customer"><i class="fas fa-user" style="font-size:15px;"></i>  Customers</a>
    <a href="staff"><i class="fas fa-person-military-pointing" style="font-size:15px;"></i>  Staffs</a>


    <div class="user">
      <p *ngIf="currentUser">{{currentUser.name}}</p>
      <button class="logout" (click)="logout()">Logout</button>
    </div>
  </div>
  <div class="view">
    <div class = "main-content">
      <router-outlet></router-outlet>
      </div>
  </div>
</div>

<div *ngIf="!loggedIn">
  <router-outlet></router-outlet>
</div> -->


<!-- <div *ngIf ="!loggedIn">
  <router-outlet></router-outlet>
</div> -->
<!-- <app-login></app-login> -->

<div *ngIf="option">
  <div class="col-md-6 col-xs-12" style="border: 1px solid grey;position:relative;overflow-x: scroll;overflow-y: scroll;height: 800px;width:50%">
    <div class ='backButton1'>
      <button mat-fab color="primary" (click)="backFunc()" [disabled]="backArray.length <= 0" >	
        <mat-icon>keyboard_backspace</mat-icon>
      </button> 
    </div>
<div id="container" class="example-boundary" [style.width.px]="floor.width" [style.height.px]="floor.height"
          (mousedown)="clearFocus()">
        
          <div class="grid" [style.height.px]="floor.height+1" [style.width.px]="floor.width+1">
            <canvas #test style="position: absolute;"></canvas>
            <img *ngIf="checkBG(ZoneInfo.bg_url)" [src]="ZoneInfo.bg_url" onError="this.src=''"
              [style.height.px]="floor.height" [style.width.px]="floor.width" style="opacity: 0.6">
            <div *ngFor="let item of objects" id="{{item.id}}" class="example-box" (click)="focus(item)" (dblclick)="openEdit(item)"
              [style.background]="checkColor(item)" [style.border]="checkBorder(item.id)"
              (cdkDragStarted)="focus(item.id)" (cdkDragEnded)="changeXY($event,item)"
              (cdkDragStarted)="startDrag($event)" [style.width.px]="item.width" [style.height.px]="item.height"
              cdkDragBoundary=".example-boundary" cdkDrag [cdkDragFreeDragPosition]="item.dragPosition"
              [style.transform]="checkRotate(item.rotate)">
              <div class=icon>
                <img id="{{item.id+'icon'}}" *ngIf="item.type==1" [style.height.px]="item.height"
                  [style.width.px]="item.width" style="margin-top: 5px;" src="./assets/picture/object.png">
                <img id="{{item.id+'icon'}}" *ngIf="item.type==2" [style.height.px]="item.height"
                  [style.width.px]="item.width" style="margin-top: 5px;" src="./assets/picture/object.png">
                <div
                  style="font-size:75%;position: absolute;top: 50%;left: 50%;color:black;transform: translate(-50%, -50%);">
                  {{item.name}}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-6 col-xs-12">
        <input type="number" min="0" [(ngModel)]="width"
  (focusout)="checkWidthChange($event)" >
  <input type="number" min="0" [(ngModel)]="height"
  (focusout)="checkHeightChange($event)">
  <button class = "button"
  (click)="changeOption()">{{checkMapText()}}</button>
  <input type="file" accept="image/*" #file style="display: none;"(change)="imageChange($event)">
<button class = "button" (click)="file.click()">Change Background</button>
    <button class = "button" (click)="saveData()">Save</button>
    <button class = "button" (click)="openCreate()">Create</button> 
    <button class="button" (click)="exportData()">Export</button>
    <input type="file" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" #import style="display: none;"(change)="importData($event)">
    <button class = "button" (click)="import.click()">Import</button>    
    <button class="button" (click)="mode()">{{checkPathText()}}</button>
    <button *ngIf ="!pathMode" class="button" (click)="pathfinder_a_star_search()">Pathfinding</button>

   



<div class="col-md-12 col-xs-12" style="display: flex;">
  <div class="example-table-container">

        <table mat-table [dataSource]="objects" class="mat-elevation-z8" style ="overflow: auto;height: 300px;">

          <ng-container matColumnDef="Id">
            <th mat-header-cell *matHeaderCellDef>  Id </th>
            <td mat-cell *matCellDef="let element"> {{element.id}} </td>
          </ng-container>
        
          <ng-container matColumnDef="Name">
            <th mat-header-cell *matHeaderCellDef> Name </th>
            <td mat-cell *matCellDef="let element"> {{element.name}} </td>
          </ng-container>

          <ng-container matColumnDef="Width">
            <th mat-header-cell *matHeaderCellDef> Width </th>
            <td mat-cell *matCellDef="let element"> {{element.width}} </td>
          </ng-container>

          <ng-container matColumnDef="Height">
            <th mat-header-cell *matHeaderCellDef> Height </th>
            <td mat-cell *matCellDef="let element"> {{element.height}} </td>
          </ng-container>

          <ng-container matColumnDef="Coordinates">
            <th mat-header-cell *matHeaderCellDef> Coordinates(X / Y) </th>
            <td mat-cell *matCellDef="let element"> ({{element.dragPosition?.x}},{{element.dragPosition?.y}}) </td>
          </ng-container>

          <ng-container matColumnDef="Edit">
            <th mat-header-cell *matHeaderCellDef>  </th>
            <td mat-cell *matCellDef="let element"> 
              <button mat-icon-button (click)="openEdit(element)" >
                 <mat-icon>edit</mat-icon>
              </button>
          </td>
          </ng-container>

          <ng-container matColumnDef="Close">
            <th mat-header-cell *matHeaderCellDef>  </th>
            <td mat-cell *matCellDef="let element"> 
              <button mat-icon-button (click)="deleteObject(element)" *ngIf ="element.type == 1">
                 <mat-icon>close</mat-icon>
              </button>
          </td>
          </ng-container>
    
        
          <tr mat-header-row *matHeaderRowDef="objectColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: objectColumns;"></tr>
        </table>
        </div>
</div>
</div>
</div>

<div *ngIf="!option">
  <div class="col-md-12 col-xs-12">
    <input type="number" min="0" [(ngModel)]="width"
    (focusout)="checkWidthChange($event)" >
    <input type="number" min="0" [(ngModel)]="height"
    (focusout)="checkHeightChange($event)">
    <button class = "button"
    (click)="changeOption()">{{checkMapText()}}</button>
    <input type="file" accept="image/*" #file style="display: none;"(change)="imageChange($event)">
    <button class = "button" (click)="file.click()">Change Background</button>
    <button class = "button" (click)="saveData()">Save</button>
    <button class = "button" (click)="openCreate()">Create</button> 
    <button class="button" (click)="exportData()">Export</button>
    <input type="file" accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel" #import style="display: none;"(change)="importData($event)">
    <button class = "button" (click)="import.click()">Import</button>   
    <button class="button" (click)="mode()">{{checkPathText()}}</button>
    <button *ngIf ="!pathMode" class="button" (click)="pathfinder_a_star_search()">Pathfinding</button>



  </div>
  <div class="col-md-12 col-xs-12" style="border: 1px solid grey;position:relative;overflow-x: scroll;overflow-y: scroll"
    [style.width.%]="95" [style.height.px]="800">
    <div class ='backButton2'>
      <button mat-fab color="primary" (click)="backFunc()" [disabled]="backArray.length <= 0" >	
        <mat-icon>keyboard_backspace</mat-icon>
      </button> 
    </div>
    <div id="container" class="example-boundary" [style.width.px]="floor.width" [style.height.px]="floor.height"
          (mousedown)="clearFocus()">
          <div class="grid" [style.height.px]="floor.height+1" [style.width.px]="floor.width+1">
            <canvas #test style="position: absolute;"></canvas>
            <img *ngIf="checkBG(ZoneInfo.bg_url)" [src]="ZoneInfo.bg_url" onError="this.src=''"
              [style.height.px]="floor.height" [style.width.px]="floor.width" style="opacity: 0.6">
            <div *ngFor="let item of objects" id="{{item.id}}" class="example-box" (click)="focus(item)" (dblclick)="openEdit(item)"
              [style.background]="checkColor(item)" [style.border]="checkBorder(item.id)"
              (cdkDragStarted)="focus(item.id)" (cdkDragEnded)="changeXY($event,item)"
              (cdkDragStarted)="startDrag($event)" [style.width.px]="item.width" [style.height.px]="item.height"
              cdkDragBoundary=".example-boundary" cdkDrag [cdkDragFreeDragPosition]="item.dragPosition"
              [style.transform]="checkRotate(item.rotate)">
              <div class=icon>
                <img id="{{item.id+'icon'}}" *ngIf="item.type==1" [style.height.px]="item.height"
                  [style.width.px]="item.width" style="margin-top: 5px;" src="./assets/picture/object.png">
                <img id="{{item.id+'icon'}}" *ngIf="item.type==2" [style.height.px]="item.height"
                  [style.width.px]="item.width" style="margin-top: 5px;" src="./assets/picture/object.png">
                <div
                  style="font-size:75%;position: absolute;top: 50%;left: 50%;color:black;transform: translate(-50%, -50%);">
                  {{item.name}}</div>
              </div>
            </div>
          </div>
        </div>
  </div>
    </div>

    <ng-template #form>
      <h2 mat-dialog-title fxLayoutAlign="center">{{createMode? "Create" : 'Edit'}}</h2>
      <mat-card-content style ='padding:10px'>
        <form>
          <table>
            <tr>
                <td >Name</td>
                <td>
                <mat-form-field class="inputBackground">
                  <input matInput class="inputField" type="text" name="name"[(ngModel)]="currentRow.name">
                </mat-form-field>
                </td>
                </tr>
             
             
            <tr>
              <td >Width</td>
              <td>
                <mat-form-field class="inputBackground">
                  <input matInput class="inputField" type="number" name="width"[(ngModel)]="currentRow.width">
                </mat-form-field>
                </td>
                </tr>
                <tr>
                  <td >Height</td>
                  <td>
                    <mat-form-field class="inputBackground">
                      <input matInput class="inputField" type="number" name="height"[(ngModel)]="currentRow.height">
                    </mat-form-field>
                    </td>
                    </tr>
                    <tr>
                      <td >Color</td>
                      <td>
                          <input style ="margin-left: 10px;"
                         [style.background]="currentRow.color" [(colorPicker)]="currentRow.color"/>
                        </td>
                        </tr>  
            </table>
          </form>
    
          <div fxLayout="row" fxLayoutAlign ="space-around center">
            <button mat-raised-button (click)="createOrEdit()">{{createMode? "Create" : 'Edit'}}</button> 
          </div>
      </mat-card-content> 
    </ng-template>